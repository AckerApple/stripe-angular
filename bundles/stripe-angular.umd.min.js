!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/common")):"function"==typeof define&&define.amd?define("stripe-angular",["exports","@angular/core","@angular/common"],t):t((e=e||self)["stripe-angular"]={},e.ng.core,e.ng.common)}(this,(function(e,t,r){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function i(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}function o(e,t,r,n){var i,o=arguments.length,a=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var p=e.length-1;p>=0;p--)(i=e[p])&&(a=(o<3?i(a):o>3?i(t,r,a):i(t,r))||a);return o>3&&a&&Object.defineProperty(t,r,a),a}function a(e,t){return function(r,n){t(r,n,e)}}function p(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,i,o=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)a.push(n.value)}catch(e){i={error:e}}finally{try{n&&!n.done&&(r=o.return)&&r.call(o)}finally{if(i)throw i.error}}return a}function c(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(p(arguments[t]));return e}var u=new t.InjectionToken("Stripe Publishable Key"),s=new t.InjectionToken("Stripe Options"),l=function(){function e(e,t){this.src="https://js.stripe.com/v3/",this.load=this.injectIntoHead(),e&&this.setPublishableKey(e,t)}return e.prototype.promiseStripe=function(){return this.load},e.prototype.promiseInstance=function(){var e=this;return this.promiseStripe().then((function(t){if(!e.StripeInstance){var r=new Error("Stripe PublishableKey NOT SET. Use method StripeScriptTag.setPublishableKey()");throw r.code="STRIPEKEYNOTSET",r}return e.StripeInstance}))},e.prototype.setPublishableKey=function(e,t){var r=this;return this.load.then((function(){return r.StripeInstance=r.Stripe(e,t)}))},e.prototype.injectIntoHead=function(){var e=this;return window.Stripe?Promise.resolve(this.Stripe=window.Stripe):new Promise((function(t,r){var n=e.getTargetTagDropElement(),i=document.createElement("script");i.setAttribute("src",e.src),i.setAttribute("type","text/javascript"),i.addEventListener("load",(function(){e.Stripe=e.grabStripe(),t(e.Stripe)})),n.appendChild(i)}))},e.prototype.grabStripe=function(){return window.Stripe},e.prototype.getTargetTagDropElement=function(){var e=document.getElementsByTagName("head");return e.length?e[0]:document.getElementsByTagName("body")[0]},e.ctorParameters=function(){return[{type:String,decorators:[{type:t.Inject,args:[u]}]},{type:void 0,decorators:[{type:t.Inject,args:[s]}]}]},e.ɵprov=t["ɵɵdefineInjectable"]({factory:function(){return new e(t["ɵɵinject"](u),t["ɵɵinject"](s))},token:e,providedIn:"root"}),e=o([t.Injectable({providedIn:"root"}),a(0,t.Inject(u)),a(1,t.Inject(s))],e)}(),d=function(){function e(e){this.StripeScriptTag=e,this.catcher=new t.EventEmitter,this.invalidChange=new t.EventEmitter}return e.prototype.ngOnInit=function(){this.init()},e.prototype.init=function(){var e=this;return this.StripeScriptTag.promiseInstance().then((function(t){return e.stripe=t}))},o([t.Output("catch")],e.prototype,"catcher",void 0),o([t.Input()],e.prototype,"invalid",void 0),o([t.Output()],e.prototype,"invalidChange",void 0),e}(),h=function(e){function r(r){var n=e.call(this,r)||this;return n.StripeScriptTag=r,n.sourceChange=new t.EventEmitter,n}return i(r,e),r.prototype.createSource=function(){var e=this;return delete this.invalid,this.invalidChange.emit(this.invalid),this.stripe.createSource(this.elements).then((function(t){if(!t.error)return e.sourceChange.emit(e.source=t.source),t.source;if("validation_error"!=t.error.type)throw e.catcher.emit(t.error),t.error;e.invalidChange.emit(e.invalid=t.error)}))},r.ctorParameters=function(){return[{type:l}]},o([t.Input()],r.prototype,"source",void 0),o([t.Output()],r.prototype,"sourceChange",void 0),r=o([t.Component({selector:"stripe-source",template:'\n      <ng-container *ngIf="!StripeScriptTag.StripeInstance">\n          <div style="color:red;">Stripe PublishableKey NOT SET. Use method StripeScriptTag.setPublishableKey()</div>\n      </ng-container>\n  ',exportAs:"StripeSource"})],r)}(d),f=function(e){function r(r,n){var i=e.call(this,n)||this;return i.ElementRef=r,i.StripeScriptTag=n,i.tokenChange=new t.EventEmitter,i}return i(r,e),r.prototype.ngOnInit=function(){var t=this;e.prototype.init.call(this).then((function(){t.elements=t.stripe.elements().create("card",t.options),t.elements.mount(t.ElementRef.nativeElement),t.elements.addEventListener("change",(function(e){e.error&&t.invalidChange.emit(t.invalid=e.error)}))}))},r.prototype.createToken=function(e){var t=this;return delete this.invalid,this.invalidChange.emit(this.invalid),this.stripe.createToken(this.elements,e).then((function(e){if(!e.error)return t.tokenChange.emit(t.token=e.token),e.token;if("validation_error"!=e.error.type)throw t.catcher.emit(e.error),e.error;t.invalidChange.emit(t.invalid=e.error)}))},r.ctorParameters=function(){return[{type:t.ElementRef},{type:l}]},o([t.Input()],r.prototype,"options",void 0),o([t.Input()],r.prototype,"token",void 0),o([t.Output()],r.prototype,"tokenChange",void 0),r=o([t.Component({selector:"stripe-card",template:'\n      <ng-container *ngIf="!StripeScriptTag.StripeInstance">\n          <div style="color:red;">Stripe PublishableKey NOT SET. Use method StripeScriptTag.setPublishableKey()</div>\n      </ng-container>\n  ',exportAs:"StripeCard"})],r)}(h),v=function(e){function r(r){var n=e.call(this,r)||this;return n.StripeScriptTag=r,n.tokenChange=new t.EventEmitter,n}return i(r,e),r.prototype.createToken=function(e){var t=this;return delete this.invalid,this.invalidChange.emit(this.invalid),this.stripe.createToken("bank_account",e).then((function(e){if(!e.error)return t.tokenChange.emit(t.token=e.token),e.token;if("validation_error"!=e.error.type)throw t.catcher.emit(e.error),e.error;t.invalidChange.emit(t.invalid=e.error)}))},r.ctorParameters=function(){return[{type:l}]},o([t.Input()],r.prototype,"options",void 0),o([t.Input()],r.prototype,"token",void 0),o([t.Output()],r.prototype,"tokenChange",void 0),r=o([t.Component({selector:"stripe-bank",template:'\n      <ng-container *ngIf="!StripeScriptTag.StripeInstance">\n          <div style="color:red;">Stripe PublishableKey NOT SET. Use method StripeScriptTag.setPublishableKey()</div>\n      </ng-container>\n  ',exportAs:"StripeBank"})],r)}(d),y=[h,f,v],g=function(){function e(){}var n;return n=e,e.forRoot=function(e,t){return{ngModule:n,providers:[l,{provide:u,useValue:e},{provide:s,useValue:t}]}},e=n=o([t.NgModule({imports:[r.CommonModule],declarations:y,exports:c(y)})],e)}(),m=g;e.Module=m,e.STRIPE_OPTIONS=s,e.STRIPE_PUBLISHABLE_KEY=u,e.StripeBank=v,e.StripeCard=f,e.StripeModule=g,e.StripeScriptTag=l,e.StripeSource=h,e.ɵa=d,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=stripe-angular.umd.min.js.map