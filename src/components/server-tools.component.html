<div class="flex-wrap flex-center">
  <div>
    <div class="child-margin-smx"
      [ngClass]="showGroup ? 'text-left text-xs' : 'flex-wrap flex-center'"
    >
      <div *ngFor="let group of apiGroups" class="cursor-pointer hover-bg-info pad-v-xxs pad-h"
        [class.bg-grey-2x]="showGroup === group"
        [ngClass] = "!showGroup && 'border-bottom-3 border-white'"
        (click)="showGroup=group;showApi=null"
      >
        <a>{{group.icon}} {{group.title}}</a>
      </div>
    </div>
  </div>

  <div *ngIf="showGroup" [class.flex-1]="!showApi"
    [ngStyle]="showApi ? {} : {'max-width':'75vw'}" class="flex-stacked"
  >
    <div class="flex-1">
      <div class="child-pad"
        [ngClass]="showApi ? 'text-left text-xs' : 'flex-wrap'"
      >
        <a *ngFor="let api of showGroup.apis" (click)="showApi=api"
          class="flex2 hover-bg-info block"
          [class.bg-grey-2x]="showApi === api"
        >
          {{api.title}}
          <div *ngIf="api.request" class="pad-left opacity-70 text-xxs" style="overflow-wrap:break-word">
            {{api.request.method}}&nbsp;/{{api.request.path}}
          </div>
        </a>
      </div>
    </div>

    <!-- additional links -->
    <div *ngIf="!showApi && showGroup.links?.length" class="text-xs pad-top-xxs flex-center opacity-30 hover-opacity-70 bg-white">
      <div class="text-dark pad-h text-center">
        <small class="opacity-70">ðŸ”— Additional resources</small>
        <div class="flex-valign-center flex-center child-margin">
          <small *ngFor="let item of showGroup.links" class="underline">
            <a [href]="item.url" class="no-a-style" target="_blank"
            >{{item.title}}</a>
          </small>
        </div>
      </div>
    </div>
  </div>

  <a id="serverToolsWrap"></a>
  <tool-wrap *ngIf="showApi" class="flex1"
    [api]="showApi" [(format)]="storage.format" [showForm]="1"
  >
    <ng-template #footer>
      <div *ngIf="showApi.related.length" class="radius-5 bg-dark text-center margin-top">
        <a class="pad-smx block" (click)="showRelated = !showRelated">
          {{ showApi.related.length }} related tasks
        </a>
        <div class="flex-wrap text-xs child-pad">
          <ng-container *ngFor="let related of showApi.related">
            <a *ngIf="showRelated || showApi[ related.relation.valueKey ]" href="#serverToolsWrap"
              class="no-a-style flex2 flex-valign-center hover-bg-positive active-bg-energized"
              (click)="gotoApi(related.api, related.relation)"
              [class.opacity-half]="!showApi[ related.relation.valueKey ]"
            >
              {{related.group?.icon ? related.group.icon + ' ' : ''}}{{related.title}}
            </a>
          </ng-container>
        </div>
      </div>

    </ng-template>
  </tool-wrap>
</div>
