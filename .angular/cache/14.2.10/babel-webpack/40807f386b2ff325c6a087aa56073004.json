{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.customerApi = exports.apis = exports.customer_get_payment_methods = exports.customer_get_source = exports.customer_get_sources = exports.customer_detach_method = exports.customer_attach_source = exports.customer_attach_method = exports.customer_get = exports.customer_update = exports.delete_customer = exports.customer_search = exports.customer_list_all = exports.create_customer = void 0;\n\nconst app_component_utils_1 = require(\"./app.component.utils\");\n\nconst banks_api_1 = require(\"./banks.api\");\n\nconst sources_api_1 = require(\"./sources.api\");\n\nconst payment_methods_api_1 = require(\"./payment_methods.api\");\n\nconst plaid_apis_1 = require(\"./plaid.apis\"); // create\n\n\nexports.create_customer = {\n  title: '🆕 Create Customer',\n  link: 'https://stripe.com/docs/api/customers',\n  favKeys: [{\n    valueKey: 'result.id'\n  }],\n  request: {\n    method: 'POST',\n    path: 'customers'\n  },\n  data: Object.assign(Object.assign({\n    description: \"some new customer\"\n  }, app_component_utils_1.sample.owner), {\n    metadata: app_component_utils_1.sample.metadata\n  }),\n  pastes: [{\n    $api: () => sources_api_1.create_source,\n    valueKey: 'result.id',\n    pasteKey: 'data.source'\n  }, {\n    $api: () => sources_api_1.card,\n    valueKey: 'result.payment_method.id',\n    pastes: [{\n      valueKey: 'result.payment_method.id',\n      pasteKey: 'data.payment_method'\n    }, {\n      valueKey: 'data.invoice_settings',\n      pasteKey: 'data.invoice_settings'\n    }, {\n      valueKey: 'data.invoice_settings.default_payment_method',\n      pasteKey: 'result.payment_method.id'\n    }]\n  }, {\n    $api: () => banks_api_1.bank,\n    valueKey: 'result.id',\n    pasteKey: 'data.source'\n  }, {\n    $api: () => sources_api_1.card,\n    valueKey: 'result.source.id',\n    pasteKey: 'data.source'\n  }, {\n    $api: () => plaid_apis_1.plaid_stripeBankCreate,\n    title: 'plaid bank token',\n    valueKey: 'result.stripe_bank_account_token',\n    pasteKey: 'data.source'\n  }]\n};\nexports.customer_list_all = {\n  title: '🧾 List all customers',\n  link: 'https://stripe.com/docs/api/customers/list',\n  request: {\n    method: 'GET',\n    path: 'customers'\n  },\n  pastes: [{\n    $api: () => exports.customer_list_all,\n    valueKey: 'result.data.0.id',\n    pasteKey: 'data.starting_after',\n    title: 'next customer'\n  }, {\n    $api: () => exports.create_customer,\n    valueKey: 'result.id',\n    pasteKey: 'data.starting_after',\n    title: '🆕 created customer'\n  }],\n  data: {\n    limit: 3,\n    \"created[lte]\": Date.now() - 1000 * 60 * 5 // greater than last five minutes\n\n  }\n};\nexports.customer_search = {\n  title: '🔎 search customers',\n  link: 'https://stripe.com/docs/search#query-fields-for-customers',\n  request: {\n    method: 'GET',\n    path: 'customers/search'\n  },\n  pastes: [],\n  data: {\n    limit: 3,\n    query: \"metadata['key']:'value'\"\n  }\n};\nexports.delete_customer = {\n  title: '❌ Delete Customer',\n  link: 'https://stripe.com/docs/api/customers/delete',\n  request: {\n    method: 'DELETE',\n    path: 'customers/:id'\n  },\n  pastes: [{\n    $api: () => exports.create_customer,\n    pasteKey: 'request.params.id',\n    valueKey: 'result.id'\n  }, {\n    $api: () => exports.customer_list_all,\n    title: 'GET customers[0]',\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.id'\n  }]\n};\nexports.customer_update = {\n  title: '⬆️ UPDATE Customer',\n  links: [{\n    title: 'docs',\n    url: 'https://stripe.com/docs/api/customers/update'\n  }],\n  request: {\n    method: 'POST',\n    path: 'customers/:id'\n  },\n  data: {\n    metadata: app_component_utils_1.sample.metadata\n  },\n  pastes: [{\n    $api: () => exports.create_customer,\n    title: 'created customer id',\n    valueKey: 'result.id',\n    pasteKey: 'request.params.id'\n  }, {\n    $api: () => exports.create_customer,\n    title: 'created customer data',\n    valueKey: 'result',\n    pasteKey: 'data',\n    removeKeys: ['account_balance', 'balance', 'object', 'cards', 'created', 'delinquent', 'livemode', 'sources', 'data', 'subscriptions', 'tax_ids']\n  }, {\n    $api: () => exports.customer_list_all,\n    title: '🧾 customer list 1️⃣',\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.id'\n  }, {\n    $api: () => sources_api_1.card,\n    valueKey: 'result.source.id',\n    pasteKey: 'data.source'\n  }, {\n    // set default card\n    $api: () => sources_api_1.card,\n    valueKey: 'result.payment_method.card',\n    pasteKey: 'data',\n    pastes: [{\n      pasteKey: 'data.payment_method',\n      valueKey: 'result.payment_method.id'\n    }, {\n      valueKey: 'result.payment_method.id',\n      pasteKey: 'data.invoice_settings.default_payment_method'\n    }]\n  }]\n};\nexports.customer_get = {\n  title: '1️⃣ GET Customer',\n  link: 'https://stripe.com/docs/api/customers/retrieve',\n  request: {\n    method: 'GET',\n    path: 'customers/:id'\n  },\n  pastes: [{\n    $api: () => exports.create_customer,\n    valueKey: 'result.id',\n    pasteKey: 'request.params.id',\n    title: '🆕 created customer'\n  }, {\n    $api: () => sources_api_1.source_get,\n    title: 'source GET customer',\n    valueKey: 'result.customer',\n    pasteKey: 'request.params.id'\n  }, {\n    $api: () => exports.customer_list_all,\n    title: '🧾 customer list 1️⃣',\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.id'\n  }]\n};\nexports.customer_attach_method = {\n  title: '👤 ➡️ 💳 Attach pay method',\n  links: [{\n    title: '📕 API docs',\n    url: 'https://stripe.com/docs/api/payment_methods/attach'\n  }],\n  request: {\n    method: 'POST',\n    path: 'payment_methods/:paymentMethodId/attach'\n  },\n  data: {\n    customer: '' // metadata: sample.metadata // not supported here\n\n  },\n  pastes: [{\n    $api: () => exports.create_customer,\n    title: 'created customer',\n    valueKey: 'result.id',\n    pasteKey: 'data.customer'\n  }, {\n    $api: () => exports.customer_list_all,\n    title: '🧾 Customer list 1️⃣',\n    valueKey: 'result.data.0.id',\n    pasteKey: 'data.customer'\n  }, {\n    $api: () => sources_api_1.card,\n    valueKey: 'result.payment_method.id',\n    pasteKey: 'request.params.paymentMethodId'\n  }]\n};\nexports.customer_attach_source = {\n  title: '👤 ➡️ 💳 🏦 attach pay source',\n  link: 'https://stripe.com/docs/sources/customers#attaching-a-source-to-a-new-customer-object',\n  favKeys: [{\n    valueKey: 'result.id'\n  }],\n  request: {\n    method: 'POST',\n    path: 'customers/:id/sources'\n  },\n  data: {\n    source: '',\n    metadata: app_component_utils_1.sample.metadata\n  },\n  pastes: [{\n    $api: () => banks_api_1.bank,\n    valueKey: 'result.id',\n    pasteKey: 'data.source',\n    title: '🏦 bank token'\n  }, {\n    $api: () => sources_api_1.create_source,\n    valueKey: 'result.source.id',\n    pasteKey: 'data.source'\n  }, {\n    $api: () => sources_api_1.card,\n    valueKey: 'result.source.id',\n    pasteKey: 'data.source',\n    title: '🆕 💳 Created card source'\n  }, {\n    $api: () => plaid_apis_1.plaid_stripeBankCreate,\n    valueKey: 'result.stripe_bank_account_token',\n    pasteKey: 'data.source',\n    title: 'plaid bank token'\n  }, {\n    $api: () => exports.create_customer,\n    valueKey: 'result.id',\n    pasteKey: 'request.params.id',\n    title: '🆕 Created customer'\n  }, {\n    $api: () => exports.customer_list_all,\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.id',\n    title: '🧾 Customer list 1️⃣'\n  }, {\n    $api: () => exports.customer_get_sources,\n    valueKey: 'result.data.0.customer',\n    pasteKey: 'request.params.id'\n  }]\n};\nexports.customer_detach_method = {\n  title: '❌ 💳 delete/detach payment method',\n  request: {\n    method: 'POST',\n    path: 'payment_methods/:id/detach'\n  },\n  data: {} // not used currently\n\n};\nexports.customer_get_sources = {\n  title: '🧾 💳 Sources list',\n  link: 'https://stripe.com/docs/api/cards/list',\n  request: {\n    method: 'GET',\n    path: 'customers/:customer/sources'\n  },\n  pastes: [{\n    $api: () => exports.create_customer,\n    valueKey: 'result.id',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => payment_methods_api_1.payment_method_get,\n    valueKey: 'result.customer',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => exports.customer_list_all,\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => exports.customer_get,\n    valueKey: 'result.id',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => exports.customer_attach_source,\n    valueKey: 'result.data.customer',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => customer_delete_source,\n    valueKey: 'request.params.customer',\n    pasteKey: 'request.params.customer'\n  }]\n};\nexports.customer_get_source = {\n  title: '1️⃣ 👤 💳 Source retrieve 1️⃣',\n  link: 'https://stripe.com/docs/api/cards/retrieve',\n  request: {\n    method: 'GET',\n    path: 'customers/:customer/sources/:source'\n  },\n  pastes: [{\n    $api: () => exports.create_customer,\n    valueKey: 'result.id',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => payment_methods_api_1.payment_method_get,\n    valueKey: 'result.customer',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => exports.customer_list_all,\n    title: 'GET customers[0]',\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => exports.customer_get_sources,\n    title: 'GET customer.sources[0].id',\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.source'\n  }]\n};\nconst customer_delete_source = {\n  title: '❌ 💳 delete/detach source',\n  links: [{\n    title: 'delete customer bank',\n    url: 'https://stripe.com/docs/api/customer_bank_accounts/delete'\n  }, {\n    title: 'delete customer card',\n    url: 'https://stripe.com/docs/api/cards/delete'\n  }],\n  request: {\n    method: 'DELETE',\n    path: 'customers/:customer/sources/:source'\n  },\n  pastes: [{\n    $api: () => exports.create_customer,\n    valueKey: 'result.id',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => payment_methods_api_1.payment_method_get,\n    valueKey: 'result.customer',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => exports.customer_list_all,\n    title: 'GET customers[0]',\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.customer'\n  }, {\n    $api: () => exports.customer_get_sources,\n    title: 'GET customer.sources[0].id',\n    valueKey: 'result.data.0.id',\n    pasteKey: 'request.params.source',\n    pastes: [{\n      valueKey: 'result.data.0.customer',\n      pasteKey: 'request.params.customer'\n    }]\n  }, {\n    $api: () => sources_api_1.create_source,\n    pasteKey: 'request.params.source',\n    valueKey: 'result.id'\n  }, {\n    $api: () => exports.customer_attach_source,\n    pasteKey: 'request.params.source',\n    valueKey: 'result.id',\n    pastes: [{\n      valueKey: 'result.customer',\n      pasteKey: 'request.params.customer'\n    }]\n  }]\n};\nexports.customer_get_payment_methods = {\n  title: '🧾 💳 list payment methods',\n  $api: () => payment_methods_api_1.get_paymethods\n};\n/*\nexport function getCustomerUpdatePayMethodPaste(\n  customer: any\n) {\n  const payMethodId = (card as any).result.payment_method?.id\n  const clone = {\n    ...customer\n  }\n  clone.payment_method = payMethodId\n  clone.invoice_settings = customer.invoice_settings || {}\n  clone.invoice_settings.default_payment_method = payMethodId\n  return clone\n}\n*/\n\nexports.apis = [exports.customer_search, exports.create_customer, exports.customer_get, exports.customer_update, exports.delete_customer, exports.customer_list_all];\nexports.customerApi = {\n  icon: '👤',\n  title: 'Customers',\n  apis: exports.apis,\n  description: 'Customer objects allow you to perform recurring charges, and to track multiple charges, that are associated with the same customer. The API allows you to create, delete, and update your customers. You can retrieve individual customers as well as a list of all your customers.',\n  groups: [{\n    title: 'payment methods',\n    description: 'end points only usable within the context of a customer',\n    apis: [exports.customer_get_payment_methods, exports.customer_attach_method, exports.customer_detach_method]\n  }, {\n    title: 'sources',\n    description: 'end points only usable within the context of a customer',\n    apis: [exports.customer_attach_source, exports.customer_get_sources, exports.customer_get_source, customer_delete_source]\n  }]\n};","map":null,"metadata":{},"sourceType":"script"}